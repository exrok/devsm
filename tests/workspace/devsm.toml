
[action.spam]
sh = """
for i in $(seq 1 100); do
  echo $i
done
"""

[action.print_key]
sh = 'cat /tmp/devsm.test.key'
require = ["gen_key"]
profiles = ["alpha", "beta"]

[action.gen_key]
sh = 'head -c10 /dev/random | base64 > /tmp/devsm.test.key'
cache.key = [{ modified = "/tmp/cat" }, { profile_changed = "print_key" }]

[service.ping]
cmd = ["ping", { var = "address" }]
var.address = { description = "IP Address to ping", default = "127.0.0.1" }

[action.ls]
cmd = ['ls', { if.profile = "verbose", then = "-v" }]
profiles = ["default", "verbose"]


[service.srv]
cmd = ["ping", "127.0.0.1"]
profiles = ["alpha", "beta"]

[[test.srv]]
sh = """
echo hello >> /tmp/trigger.alpha
inotifywait /tmp/trigger.alpha
echo ALPHA test finished
"""
require = ["srv:alpha"]

[[test.srv]]
sh = """
echo hello >> /tmp/trigger.beta
inotifywait /tmp/trigger.beta
echo BETA test finished
"""
require = ["srv:beta"]
